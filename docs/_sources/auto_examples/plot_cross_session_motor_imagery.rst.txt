
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_cross_session_motor_imagery.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plot_cross_session_motor_imagery.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_cross_session_motor_imagery.py:


===========================
Cross-Session Motor Imagery
===========================

This example show how to perform a cross session motor imagery analysis on the
very popular dataset 2a from the BCI competition IV.

We will compare two pipelines :

- CSP+LDA
- Riemannian Geometry+Logistic Regression

We will use the LeftRightImagery paradigm. This will restrict the analysis
to two classes (left hand versus right hand) and use AUC as metric.

The cross session evaluation context will evaluate performance using a leave
one session out cross-validation. For each session in the dataset, a model
is trained on every other session and performance are evaluated on the current
session.

.. GENERATED FROM PYTHON SOURCE LINES 22-44

.. code-block:: default

    # Authors: Alexandre Barachant <alexandre.barachant@gmail.com>
    #          Sylvain Chevallier <sylvain.chevallier@uvsq.fr>
    #
    # License: BSD (3-clause)

    import matplotlib.pyplot as plt
    import seaborn as sns
    from mne.decoding import CSP
    from pyriemann.estimation import Covariances
    from pyriemann.tangentspace import TangentSpace
    from sklearn.discriminant_analysis import LinearDiscriminantAnalysis as LDA
    from sklearn.linear_model import LogisticRegression
    from sklearn.pipeline import make_pipeline

    import moabb
    from moabb.datasets import BNCI2014001
    from moabb.evaluations import CrossSessionEvaluation
    from moabb.paradigms import LeftRightImagery


    moabb.set_log_level("info")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/seaborn/cm.py:1582: UserWarning: Trying to register the cmap 'rocket' which already exists.
      mpl_cm.register_cmap(_name, _cmap)
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/seaborn/cm.py:1583: UserWarning: Trying to register the cmap 'rocket_r' which already exists.
      mpl_cm.register_cmap(_name + "_r", _cmap_r)
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/seaborn/cm.py:1582: UserWarning: Trying to register the cmap 'mako' which already exists.
      mpl_cm.register_cmap(_name, _cmap)
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/seaborn/cm.py:1583: UserWarning: Trying to register the cmap 'mako_r' which already exists.
      mpl_cm.register_cmap(_name + "_r", _cmap_r)
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/seaborn/cm.py:1582: UserWarning: Trying to register the cmap 'icefire' which already exists.
      mpl_cm.register_cmap(_name, _cmap)
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/seaborn/cm.py:1583: UserWarning: Trying to register the cmap 'icefire_r' which already exists.
      mpl_cm.register_cmap(_name + "_r", _cmap_r)
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/seaborn/cm.py:1582: UserWarning: Trying to register the cmap 'vlag' which already exists.
      mpl_cm.register_cmap(_name, _cmap)
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/seaborn/cm.py:1583: UserWarning: Trying to register the cmap 'vlag_r' which already exists.
      mpl_cm.register_cmap(_name + "_r", _cmap_r)
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/seaborn/cm.py:1582: UserWarning: Trying to register the cmap 'flare' which already exists.
      mpl_cm.register_cmap(_name, _cmap)
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/seaborn/cm.py:1583: UserWarning: Trying to register the cmap 'flare_r' which already exists.
      mpl_cm.register_cmap(_name + "_r", _cmap_r)
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/seaborn/cm.py:1582: UserWarning: Trying to register the cmap 'crest' which already exists.
      mpl_cm.register_cmap(_name, _cmap)
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/seaborn/cm.py:1583: UserWarning: Trying to register the cmap 'crest_r' which already exists.
      mpl_cm.register_cmap(_name + "_r", _cmap_r)




.. GENERATED FROM PYTHON SOURCE LINES 45-55

Create Pipelines
----------------

Pipelines must be a dict of sklearn pipeline transformer.

The CSP implementation is based on the MNE implementation. We selected 8 CSP
components, as usually done in the literature.

The Riemannian geometry pipeline consists in covariance estimation, tangent
space mapping and finally a logistic regression for the classification.

.. GENERATED FROM PYTHON SOURCE LINES 55-64

.. code-block:: default


    pipelines = {}

    pipelines["CSP+LDA"] = make_pipeline(CSP(n_components=8), LDA())

    pipelines["RG+LR"] = make_pipeline(
        Covariances(), TangentSpace(), LogisticRegression(solver="lbfgs")
    )








.. GENERATED FROM PYTHON SOURCE LINES 65-75

Evaluation
----------

We define the paradigm (LeftRightImagery) and the dataset (BNCI2014001).
The evaluation will return a DataFrame containing a single AUC score for
each subject / session of the dataset, and for each pipeline.

Results are saved into the database, so that if you add a new pipeline, it
will not run again the evaluation unless a parameter has changed. Results can
be overwritten if necessary.

.. GENERATED FROM PYTHON SOURCE LINES 75-90

.. code-block:: default


    paradigm = LeftRightImagery()
    # Because this is being auto-generated we only use 2 subjects
    dataset = BNCI2014001()
    dataset.subject_list = dataset.subject_list[:2]
    datasets = [dataset]
    overwrite = False  # set to True if we want to overwrite cached results
    evaluation = CrossSessionEvaluation(
        paradigm=paradigm, datasets=datasets, suffix="examples", overwrite=overwrite
    )

    results = evaluation.process(pipelines)

    print(results.head())





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/runner/work/moabb/moabb/moabb/analysis/results.py:79: RuntimeWarning: Setting non-standard config type: "MOABB_RESULTS"
      set_config("MOABB_RESULTS", osp.join(osp.expanduser("~"), "mne_data"))
    2022-05-16 14:41:46,158 INFO MainThread moabb.evaluations.base Processing dataset: 001-2014
    001-2014-CrossSession:   0%|          | 0/2 [00:00<?, ?it/s]MNE_DATA is not already configured. It will be set to default location in the home directory - /home/runner/mne_data
    All datasets will be downloaded to this location, if anything is already downloaded, please move manually to this location
    /home/runner/work/moabb/moabb/moabb/datasets/download.py:53: RuntimeWarning: Setting non-standard config type: "MNE_DATASETS_BNCI_PATH"
      set_config(key, get_config("MNE_DATA"))

      0%|                                              | 0.00/42.8M [00:00<?, ?B/s][A
      0%|                                   | 1.02k/42.8M [00:00<1:28:04, 8.10kB/s][A
      0%|                                     | 17.4k/42.8M [00:00<08:59, 79.3kB/s][A
      0%|                                      | 33.8k/42.8M [00:00<06:58, 102kB/s][A
      0%|                                      | 50.2k/42.8M [00:00<06:18, 113kB/s][A
      0%|                                      | 82.9k/42.8M [00:00<04:18, 166kB/s][A
      0%|                                       | 100k/42.8M [00:00<04:33, 156kB/s][A
      0%|                                       | 132k/42.8M [00:00<03:48, 187kB/s][A
      0%|▏                                      | 152k/42.8M [00:01<04:01, 176kB/s][A
      0%|▏                                      | 198k/42.8M [00:01<03:01, 235kB/s][A
      1%|▏                                      | 230k/42.8M [00:01<02:55, 242kB/s][A
      1%|▎                                      | 280k/42.8M [00:01<02:28, 287kB/s][A
      1%|▎                                      | 329k/42.8M [00:01<02:13, 318kB/s][A
      1%|▎                                      | 378k/42.8M [00:01<02:05, 339kB/s][A
      1%|▍                                      | 443k/42.8M [00:01<01:47, 393kB/s][A
      1%|▍                                      | 509k/42.8M [00:01<01:38, 431kB/s][A
      1%|▌                                      | 574k/42.8M [00:02<01:32, 457kB/s][A
      1%|▌                                      | 640k/42.8M [00:02<01:28, 475kB/s][A
      2%|▋                                      | 738k/42.8M [00:02<01:14, 565kB/s][A
      2%|▋                                      | 820k/42.8M [00:02<01:11, 590kB/s][A
      2%|▊                                      | 902k/42.8M [00:02<01:09, 607kB/s][A
      2%|▉                                      | 984k/42.8M [00:02<01:07, 619kB/s][A
      3%|▉                                     | 1.08M/42.8M [00:02<01:02, 667kB/s][A
      3%|█                                     | 1.21M/42.8M [00:02<00:53, 777kB/s][A
      3%|█▏                                    | 1.36M/42.8M [00:03<00:46, 890kB/s][A
      4%|█▎                                    | 1.51M/42.8M [00:03<00:42, 972kB/s][A
      4%|█▍                                   | 1.67M/42.8M [00:03<00:38, 1.06MB/s][A
      4%|█▌                                   | 1.80M/42.8M [00:03<00:38, 1.05MB/s][A
      5%|█▋                                   | 1.98M/42.8M [00:03<00:35, 1.16MB/s][A
      5%|█▉                                   | 2.18M/42.8M [00:03<00:31, 1.28MB/s][A
      6%|██                                   | 2.38M/42.8M [00:03<00:29, 1.36MB/s][A
      6%|██▏                                  | 2.57M/42.8M [00:03<00:28, 1.42MB/s][A
      6%|██▍                                  | 2.75M/42.8M [00:04<00:28, 1.42MB/s][A
      7%|██▌                                  | 3.02M/42.8M [00:04<00:24, 1.62MB/s][A
      8%|██▊                                  | 3.28M/42.8M [00:04<00:22, 1.75MB/s][A
      8%|███                                  | 3.59M/42.8M [00:04<00:20, 1.96MB/s][A
      9%|███▍                                 | 3.93M/42.8M [00:04<00:17, 2.18MB/s][A
     10%|███▋                                 | 4.29M/42.8M [00:04<00:16, 2.38MB/s][A
     11%|████                                 | 4.69M/42.8M [00:04<00:14, 2.56MB/s][A
     12%|████▍                                | 5.11M/42.8M [00:04<00:13, 2.79MB/s][A
     13%|████▊                                | 5.52M/42.8M [00:05<00:12, 2.92MB/s][A
     14%|█████▏                               | 6.00M/42.8M [00:05<00:11, 3.16MB/s][A
     15%|█████▌                               | 6.49M/42.8M [00:05<00:10, 3.35MB/s][A
     16%|██████                               | 7.03M/42.8M [00:05<00:09, 3.61MB/s][A
     18%|██████▌                              | 7.60M/42.8M [00:05<00:09, 3.89MB/s][A
     19%|███████                              | 8.24M/42.8M [00:05<00:08, 4.22MB/s][A
     21%|███████▋                             | 8.91M/42.8M [00:05<00:07, 4.55MB/s][A
     23%|████████▎                            | 9.65M/42.8M [00:05<00:06, 4.92MB/s][A
     24%|█████████                            | 10.4M/42.8M [00:06<00:06, 5.31MB/s][A
     26%|█████████▊                           | 11.3M/42.8M [00:06<00:05, 5.75MB/s][A
     29%|██████████▌                          | 12.3M/42.8M [00:06<00:04, 6.27MB/s][A
     31%|███████████▍                         | 13.3M/42.8M [00:06<00:04, 6.83MB/s][A
     34%|████████████▍                        | 14.4M/42.8M [00:06<00:03, 7.34MB/s][A
     36%|█████████████▍                       | 15.5M/42.8M [00:06<00:03, 7.93MB/s][A
     39%|██████████████▌                      | 16.8M/42.8M [00:06<00:03, 8.49MB/s][A
     43%|███████████████▋                     | 18.2M/42.8M [00:06<00:02, 9.27MB/s][A
     46%|█████████████████                    | 19.7M/42.8M [00:07<00:02, 10.1MB/s][A
     50%|██████████████████▍                  | 21.4M/42.8M [00:07<00:01, 11.0MB/s][A
     54%|████████████████████                 | 23.2M/42.8M [00:07<00:01, 11.9MB/s][A
     59%|█████████████████████▋               | 25.1M/42.8M [00:07<00:01, 12.8MB/s][A
     63%|███████████████████████▍             | 27.2M/42.8M [00:07<00:01, 13.9MB/s][A
     69%|█████████████████████████▍           | 29.4M/42.8M [00:07<00:00, 15.1MB/s][A
     74%|███████████████████████████▌         | 31.8M/42.8M [00:07<00:00, 16.2MB/s][A
     80%|█████████████████████████████▊       | 34.4M/42.8M [00:08<00:00, 17.5MB/s][A
     87%|████████████████████████████████▏    | 37.2M/42.8M [00:08<00:00, 18.8MB/s][A
     94%|██████████████████████████████████▋  | 40.1M/42.8M [00:08<00:00, 20.0MB/s][A
      0%|                                              | 0.00/42.8M [00:00<?, ?B/s][A    100%|█████████████████████████████████████| 42.8M/42.8M [00:00<00:00, 51.7GB/s]

      0%|                                              | 0.00/43.8M [00:00<?, ?B/s][A
      0%|                                   | 1.02k/43.8M [00:00<1:35:57, 7.60kB/s][A
      0%|                                     | 17.4k/43.8M [00:00<09:46, 74.7kB/s][A
      0%|                                      | 50.2k/43.8M [00:00<04:48, 152kB/s][A
      0%|                                      | 66.6k/43.8M [00:00<05:12, 140kB/s][A
      0%|                                      | 82.9k/43.8M [00:00<05:27, 133kB/s][A
      0%|                                       | 116k/43.8M [00:00<04:15, 171kB/s][A
      0%|▏                                      | 148k/43.8M [00:00<03:43, 195kB/s][A
      0%|▏                                      | 181k/43.8M [00:01<03:27, 210kB/s][A
      1%|▏                                      | 230k/43.8M [00:01<02:48, 259kB/s][A
      1%|▏                                      | 280k/43.8M [00:01<02:28, 292kB/s][A
      1%|▎                                      | 329k/43.8M [00:01<02:18, 314kB/s][A
      1%|▎                                      | 394k/43.8M [00:01<01:58, 367kB/s][A
      1%|▍                                      | 460k/43.8M [00:01<01:47, 403kB/s][A
      1%|▍                                      | 509k/43.8M [00:01<01:50, 392kB/s][A
      1%|▌                                      | 591k/43.8M [00:02<01:34, 457kB/s][A
      2%|▌                                      | 689k/43.8M [00:02<01:19, 540kB/s][A
      2%|▋                                      | 755k/43.8M [00:02<01:22, 524kB/s][A
      2%|▊                                      | 853k/43.8M [00:02<01:13, 586kB/s][A
      2%|▊                                      | 968k/43.8M [00:02<01:04, 665kB/s][A
      2%|▉                                     | 1.08M/43.8M [00:02<00:59, 720kB/s][A
      3%|█                                     | 1.20M/43.8M [00:02<00:56, 760kB/s][A
      3%|█▏                                    | 1.33M/43.8M [00:02<00:51, 822kB/s][A
      3%|█▎                                    | 1.48M/43.8M [00:03<00:46, 902kB/s][A
      4%|█▍                                    | 1.62M/43.8M [00:03<00:43, 961kB/s][A
      4%|█▍                                   | 1.77M/43.8M [00:03<00:41, 1.00MB/s][A
      4%|█▋                                    | 1.90M/43.8M [00:03<00:42, 994kB/s][A
      5%|█▋                                   | 2.05M/43.8M [00:03<00:40, 1.02MB/s][A
      5%|█▉                                   | 2.23M/43.8M [00:03<00:37, 1.12MB/s][A
      6%|██                                   | 2.41M/43.8M [00:03<00:34, 1.19MB/s][A
      6%|██▏                                  | 2.62M/43.8M [00:04<00:31, 1.30MB/s][A
      7%|██▍                                  | 2.87M/43.8M [00:04<00:28, 1.44MB/s][A
      7%|██▌                                  | 3.05M/43.8M [00:04<00:28, 1.41MB/s][A
      8%|██▊                                  | 3.31M/43.8M [00:04<00:25, 1.57MB/s][A
      8%|███                                  | 3.59M/43.8M [00:04<00:23, 1.72MB/s][A
      9%|███▎                                 | 3.88M/43.8M [00:04<00:21, 1.84MB/s][A
      9%|███▌                                 | 4.15M/43.8M [00:04<00:21, 1.87MB/s][A
     10%|███▊                                 | 4.47M/43.8M [00:04<00:19, 2.04MB/s][A
     11%|████                                 | 4.82M/43.8M [00:05<00:17, 2.20MB/s][A
     12%|████▍                                | 5.21M/43.8M [00:05<00:15, 2.42MB/s][A
     13%|████▊                                | 5.62M/43.8M [00:05<00:14, 2.60MB/s][A
     14%|█████▏                               | 6.06M/43.8M [00:05<00:13, 2.77MB/s][A
     15%|█████▌                               | 6.55M/43.8M [00:05<00:12, 3.04MB/s][A
     16%|█████▉                               | 7.03M/43.8M [00:05<00:11, 3.18MB/s][A
     17%|██████▎                              | 7.54M/43.8M [00:05<00:10, 3.36MB/s][A
     19%|██████▉                              | 8.14M/43.8M [00:06<00:09, 3.70MB/s][A
     20%|███████▍                             | 8.77M/43.8M [00:06<00:08, 3.97MB/s][A
     21%|███████▉                             | 9.41M/43.8M [00:06<00:08, 4.20MB/s][A
     23%|████████▌                            | 10.1M/43.8M [00:06<00:07, 4.50MB/s][A
     25%|█████████▏                           | 10.9M/43.8M [00:06<00:06, 4.83MB/s][A
     27%|█████████▉                           | 11.7M/43.8M [00:06<00:06, 5.15MB/s][A
     29%|██████████▌                          | 12.6M/43.8M [00:06<00:05, 5.54MB/s][A
     31%|███████████▎                         | 13.5M/43.8M [00:07<00:05, 5.88MB/s][A
     33%|████████████▏                        | 14.4M/43.8M [00:07<00:04, 6.31MB/s][A
     35%|█████████████                        | 15.5M/43.8M [00:07<00:04, 6.73MB/s][A
     38%|██████████████                       | 16.6M/43.8M [00:07<00:03, 7.23MB/s][A
     41%|███████████████                      | 17.8M/43.8M [00:07<00:03, 7.73MB/s][A
     44%|████████████████▏                    | 19.1M/43.8M [00:07<00:02, 8.27MB/s][A
     47%|█████████████████▎                   | 20.5M/43.8M [00:07<00:02, 8.86MB/s][A
     50%|██████████████████▌                  | 22.0M/43.8M [00:07<00:02, 9.53MB/s][A
     54%|███████████████████▉                 | 23.6M/43.8M [00:08<00:01, 10.2MB/s][A
     58%|█████████████████████▍               | 25.3M/43.8M [00:08<00:01, 11.0MB/s][A
     62%|██████████████████████▉              | 27.2M/43.8M [00:08<00:01, 11.8MB/s][A
     67%|████████████████████████▌            | 29.1M/43.8M [00:08<00:01, 12.6MB/s][A
     71%|██████████████████████████▍          | 31.2M/43.8M [00:08<00:00, 13.4MB/s][A
     76%|████████████████████████████▎        | 33.5M/43.8M [00:08<00:00, 14.4MB/s][A
     82%|██████████████████████████████▎      | 35.9M/43.8M [00:08<00:00, 15.4MB/s][A
     88%|████████████████████████████████▌    | 38.5M/43.8M [00:09<00:00, 16.6MB/s][A
     94%|██████████████████████████████████▊  | 41.2M/43.8M [00:09<00:00, 17.7MB/s][A
      0%|                                              | 0.00/43.8M [00:00<?, ?B/s][A    100%|█████████████████████████████████████| 43.8M/43.8M [00:00<00:00, 53.1GB/s]
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/utils/check.py:92: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      LooseVersion(library.__version__) < LooseVersion(min_version):
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/utils/check.py:92: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      LooseVersion(library.__version__) < LooseVersion(min_version):
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/utils/check.py:92: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      LooseVersion(library.__version__) < LooseVersion(min_version):
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/utils/check.py:92: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      LooseVersion(library.__version__) < LooseVersion(min_version):
    2022-05-16 14:42:09,331 INFO MainThread moabb.evaluations.base CSP+LDA | 001-2014 | 1 | session_E: Score 0.955
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/utils/check.py:92: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      LooseVersion(library.__version__) < LooseVersion(min_version):
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/utils/check.py:92: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      LooseVersion(library.__version__) < LooseVersion(min_version):
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/utils/check.py:92: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      LooseVersion(library.__version__) < LooseVersion(min_version):
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/utils/check.py:92: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      LooseVersion(library.__version__) < LooseVersion(min_version):
    2022-05-16 14:42:09,692 INFO MainThread moabb.evaluations.base CSP+LDA | 001-2014 | 1 | session_T: Score 0.932
    2022-05-16 14:42:10,106 INFO MainThread moabb.evaluations.base RG+LR | 001-2014 | 1 | session_E: Score 0.963
    2022-05-16 14:42:10,516 INFO MainThread moabb.evaluations.base RG+LR | 001-2014 | 1 | session_T: Score 0.950
    001-2014-CrossSession:  50%|#####     | 1/2 [00:24<00:24, 24.36s/it]
      0%|                                              | 0.00/43.1M [00:00<?, ?B/s][A
      0%|                                   | 1.02k/43.1M [00:00<1:28:43, 8.09kB/s][A
      0%|                                     | 17.4k/43.1M [00:00<09:02, 79.3kB/s][A
      0%|                                      | 33.8k/43.1M [00:00<07:01, 102kB/s][A
      0%|                                      | 50.2k/43.1M [00:00<06:26, 111kB/s][A
      0%|                                      | 82.9k/43.1M [00:00<04:22, 164kB/s][A
      0%|                                       | 100k/43.1M [00:00<04:37, 155kB/s][A
      0%|                                       | 132k/43.1M [00:00<03:50, 186kB/s][A
      0%|▏                                      | 152k/43.1M [00:01<04:04, 176kB/s][A
      0%|▏                                      | 181k/43.1M [00:01<03:40, 194kB/s][A
      1%|▏                                      | 230k/43.1M [00:01<02:48, 254kB/s][A
      1%|▏                                      | 263k/43.1M [00:01<02:47, 256kB/s][A
      1%|▎                                      | 296k/43.1M [00:01<02:46, 257kB/s][A
      1%|▎                                      | 329k/43.1M [00:01<02:46, 257kB/s][A
      1%|▎                                      | 378k/43.1M [00:01<02:23, 297kB/s][A
      1%|▍                                      | 427k/43.1M [00:01<02:11, 324kB/s][A
      1%|▍                                      | 476k/43.1M [00:02<02:03, 344kB/s][A
      1%|▍                                      | 542k/43.1M [00:02<01:47, 396kB/s][A
      1%|▌                                      | 624k/43.1M [00:02<01:30, 471kB/s][A
      2%|▌                                      | 689k/43.1M [00:02<01:27, 485kB/s][A
      2%|▋                                      | 771k/43.1M [00:02<01:19, 534kB/s][A
      2%|▊                                      | 853k/43.1M [00:02<01:14, 567kB/s][A
      2%|▊                                      | 951k/43.1M [00:02<01:07, 623kB/s][A
      2%|▉                                     | 1.05M/43.1M [00:02<01:02, 668kB/s][A
      3%|█                                     | 1.15M/43.1M [00:03<00:59, 699kB/s][A
      3%|█                                     | 1.26M/43.1M [00:03<00:54, 761kB/s][A
      3%|█▏                                    | 1.38M/43.1M [00:03<00:51, 804kB/s][A
      4%|█▎                                    | 1.51M/43.1M [00:03<00:47, 871kB/s][A
      4%|█▍                                    | 1.64M/43.1M [00:03<00:45, 920kB/s][A
      4%|█▌                                    | 1.79M/43.1M [00:03<00:41, 991kB/s][A
      5%|█▋                                   | 1.95M/43.1M [00:03<00:38, 1.08MB/s][A
      5%|█▊                                   | 2.10M/43.1M [00:03<00:37, 1.11MB/s][A
      5%|█▉                                   | 2.23M/43.1M [00:04<00:37, 1.08MB/s][A
      6%|██                                   | 2.41M/43.1M [00:04<00:34, 1.17MB/s][A
      6%|██▏                                  | 2.54M/43.1M [00:04<00:35, 1.15MB/s][A
      6%|██▎                                  | 2.75M/43.1M [00:04<00:30, 1.30MB/s][A
      7%|██▌                                  | 2.93M/43.1M [00:04<00:29, 1.34MB/s][A
      7%|██▋                                  | 3.16M/43.1M [00:04<00:26, 1.48MB/s][A
      8%|██▉                                  | 3.38M/43.1M [00:04<00:25, 1.54MB/s][A
      8%|███▏                                 | 3.64M/43.1M [00:04<00:23, 1.70MB/s][A
      9%|███▎                                 | 3.92M/43.1M [00:05<00:21, 1.85MB/s][A
     10%|███▋                                 | 4.24M/43.1M [00:05<00:18, 2.07MB/s][A
     11%|███▉                                 | 4.59M/43.1M [00:05<00:17, 2.21MB/s][A
     11%|████▎                                | 4.95M/43.1M [00:05<00:15, 2.40MB/s][A
     12%|████▌                                | 5.29M/43.1M [00:05<00:15, 2.49MB/s][A
     13%|████▉                                | 5.72M/43.1M [00:05<00:13, 2.75MB/s][A
     14%|█████▎                               | 6.18M/43.1M [00:05<00:12, 3.01MB/s][A
     16%|█████▋                               | 6.69M/43.1M [00:05<00:11, 3.30MB/s][A
     17%|██████▏                              | 7.16M/43.1M [00:06<00:10, 3.43MB/s][A
     18%|██████▌                              | 7.67M/43.1M [00:06<00:09, 3.61MB/s][A
     19%|███████                              | 8.27M/43.1M [00:06<00:08, 3.96MB/s][A
     21%|███████▋                             | 8.91M/43.1M [00:06<00:07, 4.28MB/s][A
     22%|████████▎                            | 9.67M/43.1M [00:06<00:07, 4.74MB/s][A
     24%|████████▉                            | 10.5M/43.1M [00:06<00:06, 5.22MB/s][A
     26%|█████████▋                           | 11.3M/43.1M [00:06<00:05, 5.61MB/s][A
     29%|██████████▌                          | 12.3M/43.1M [00:07<00:04, 6.21MB/s][A
     31%|███████████▍                         | 13.3M/43.1M [00:07<00:04, 6.77MB/s][A
     34%|████████████▍                        | 14.5M/43.1M [00:07<00:03, 7.40MB/s][A
     36%|█████████████▍                       | 15.7M/43.1M [00:07<00:03, 7.99MB/s][A
     39%|██████████████▌                      | 16.9M/43.1M [00:07<00:03, 8.62MB/s][A
     42%|███████████████▋                     | 18.3M/43.1M [00:07<00:02, 9.14MB/s][A
     46%|████████████████▉                    | 19.8M/43.1M [00:07<00:02, 9.97MB/s][A
     50%|██████████████████▎                  | 21.4M/43.1M [00:07<00:02, 10.8MB/s][A
     54%|███████████████████▉                 | 23.2M/43.1M [00:08<00:01, 11.8MB/s][A
     58%|█████████████████████▌               | 25.1M/43.1M [00:08<00:01, 12.8MB/s][A
     63%|███████████████████████▎             | 27.1M/43.1M [00:08<00:01, 13.8MB/s][A
     68%|█████████████████████████▎           | 29.4M/43.1M [00:08<00:00, 15.0MB/s][A
     74%|███████████████████████████▎         | 31.8M/43.1M [00:08<00:00, 16.3MB/s][A
     80%|█████████████████████████████▌       | 34.5M/43.1M [00:08<00:00, 17.5MB/s][A
     86%|███████████████████████████████▉     | 37.2M/43.1M [00:08<00:00, 18.8MB/s][A
     93%|██████████████████████████████████▍  | 40.0M/43.1M [00:08<00:00, 19.9MB/s][A
    100%|████████████████████████████████████▉| 42.9M/43.1M [00:09<00:00, 20.7MB/s][A
      0%|                                              | 0.00/43.1M [00:00<?, ?B/s][A    100%|█████████████████████████████████████| 43.1M/43.1M [00:00<00:00, 56.8GB/s]

      0%|                                              | 0.00/44.2M [00:00<?, ?B/s][A
      0%|                                   | 1.02k/44.2M [00:00<1:36:29, 7.64kB/s][A
      0%|                                     | 17.4k/44.2M [00:00<09:50, 74.8kB/s][A
      0%|                                     | 33.8k/44.2M [00:00<07:38, 96.4kB/s][A
      0%|                                      | 66.6k/44.2M [00:00<04:45, 155kB/s][A
      0%|                                      | 82.9k/44.2M [00:00<05:09, 143kB/s][A
      0%|                                      | 99.3k/44.2M [00:00<05:25, 136kB/s][A
      0%|                                       | 132k/44.2M [00:00<04:17, 171kB/s][A
      0%|▏                                      | 165k/44.2M [00:01<03:46, 194kB/s][A
      0%|▏                                      | 198k/44.2M [00:01<03:29, 210kB/s][A
      0%|▏                                      | 219k/44.2M [00:01<03:46, 194kB/s][A
      1%|▏                                      | 263k/44.2M [00:01<03:06, 235kB/s][A
      1%|▎                                      | 296k/44.2M [00:01<03:04, 238kB/s][A
      1%|▎                                      | 345k/44.2M [00:01<02:38, 277kB/s][A
      1%|▎                                      | 411k/44.2M [00:01<02:08, 340kB/s][A
      1%|▍                                      | 460k/44.2M [00:02<02:05, 348kB/s][A
      1%|▍                                      | 525k/44.2M [00:02<01:52, 390kB/s][A
      1%|▌                                      | 607k/44.2M [00:02<01:35, 456kB/s][A
      2%|▌                                      | 689k/44.2M [00:02<01:27, 496kB/s][A
      2%|▋                                      | 755k/44.2M [00:02<01:27, 499kB/s][A
      2%|▋                                      | 837k/44.2M [00:02<01:22, 526kB/s][A
      2%|▊                                      | 919k/44.2M [00:02<01:18, 551kB/s][A
      2%|▊                                     | 1.02M/44.2M [00:02<01:11, 603kB/s][A
      3%|▉                                     | 1.13M/44.2M [00:03<01:03, 677kB/s][A
      3%|█                                     | 1.25M/44.2M [00:03<00:58, 729kB/s][A
      3%|█▏                                    | 1.38M/44.2M [00:03<00:53, 803kB/s][A
      3%|█▎                                    | 1.52M/44.2M [00:03<00:48, 888kB/s][A
      4%|█▍                                    | 1.67M/44.2M [00:03<00:44, 950kB/s][A
      4%|█▌                                   | 1.85M/44.2M [00:03<00:40, 1.05MB/s][A
      5%|█▋                                   | 2.03M/44.2M [00:03<00:37, 1.12MB/s][A
      5%|█▊                                   | 2.23M/44.2M [00:04<00:34, 1.22MB/s][A
      5%|██                                   | 2.43M/44.2M [00:04<00:32, 1.29MB/s][A
      6%|██▏                                  | 2.66M/44.2M [00:04<00:29, 1.41MB/s][A
      6%|██▍                                  | 2.87M/44.2M [00:04<00:28, 1.46MB/s][A
      7%|██▌                                  | 3.06M/44.2M [00:04<00:28, 1.46MB/s][A
      8%|██▊                                  | 3.33M/44.2M [00:04<00:25, 1.60MB/s][A
      8%|███                                  | 3.61M/44.2M [00:04<00:23, 1.74MB/s][A
      9%|███▎                                 | 3.90M/44.2M [00:05<00:21, 1.87MB/s][A
      9%|███▍                                 | 4.15M/44.2M [00:05<00:21, 1.86MB/s][A
     10%|███▊                                 | 4.49M/44.2M [00:05<00:19, 2.06MB/s][A
     11%|████                                 | 4.79M/44.2M [00:05<00:18, 2.10MB/s][A
     12%|████▎                                | 5.16M/44.2M [00:05<00:16, 2.31MB/s][A
     13%|████▋                                | 5.56M/44.2M [00:05<00:15, 2.49MB/s][A
     14%|█████                                | 5.98M/44.2M [00:05<00:14, 2.68MB/s][A
     14%|█████▎                               | 6.39M/44.2M [00:05<00:13, 2.79MB/s][A
     16%|█████▊                               | 6.88M/44.2M [00:06<00:12, 3.05MB/s][A
     17%|██████▏                              | 7.39M/44.2M [00:06<00:11, 3.26MB/s][A
     18%|██████▋                              | 7.98M/44.2M [00:06<00:10, 3.60MB/s][A
     19%|███████▏                             | 8.57M/44.2M [00:06<00:09, 3.83MB/s][A
     21%|███████▋                             | 9.24M/44.2M [00:06<00:08, 4.18MB/s][A
     22%|████████▎                            | 9.95M/44.2M [00:06<00:07, 4.50MB/s][A
     24%|████████▉                            | 10.7M/44.2M [00:06<00:06, 4.90MB/s][A
     26%|█████████▋                           | 11.6M/44.2M [00:07<00:06, 5.26MB/s][A
     28%|██████████▍                          | 12.5M/44.2M [00:07<00:05, 5.64MB/s][A
     30%|███████████▏                         | 13.4M/44.2M [00:07<00:05, 6.05MB/s][A
     33%|████████████                         | 14.4M/44.2M [00:07<00:04, 6.50MB/s][A
     35%|████████████▉                        | 15.5M/44.2M [00:07<00:04, 6.96MB/s][A
     38%|█████████████▉                       | 16.7M/44.2M [00:07<00:03, 7.48MB/s][A
     41%|██████████████▉                      | 17.9M/44.2M [00:07<00:03, 8.01MB/s][A
     44%|████████████████                     | 19.3M/44.2M [00:07<00:02, 8.59MB/s][A
     47%|█████████████████▎                   | 20.7M/44.2M [00:08<00:02, 9.24MB/s][A
     50%|██████████████████▋                  | 22.3M/44.2M [00:08<00:02, 9.94MB/s][A
     54%|████████████████████                 | 24.0M/44.2M [00:08<00:01, 10.7MB/s][A
     58%|█████████████████████▌               | 25.7M/44.2M [00:08<00:01, 11.4MB/s][A
     62%|███████████████████████              | 27.6M/44.2M [00:08<00:01, 11.9MB/s][A
     67%|████████████████████████▋            | 29.6M/44.2M [00:08<00:01, 13.0MB/s][A
     72%|██████████████████████████▌          | 31.7M/44.2M [00:08<00:00, 13.5MB/s][A
     77%|████████████████████████████▍        | 33.9M/44.2M [00:09<00:00, 14.4MB/s][A
     82%|██████████████████████████████▍      | 36.3M/44.2M [00:09<00:00, 15.4MB/s][A
     88%|████████████████████████████████▌    | 38.8M/44.2M [00:09<00:00, 16.4MB/s][A
     94%|██████████████████████████████████▊  | 41.6M/44.2M [00:09<00:00, 17.6MB/s][A
      0%|                                              | 0.00/44.2M [00:00<?, ?B/s][A    100%|█████████████████████████████████████| 44.2M/44.2M [00:00<00:00, 55.1GB/s]
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/utils/check.py:92: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      LooseVersion(library.__version__) < LooseVersion(min_version):
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/utils/check.py:92: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      LooseVersion(library.__version__) < LooseVersion(min_version):
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/utils/check.py:92: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      LooseVersion(library.__version__) < LooseVersion(min_version):
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/utils/check.py:92: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      LooseVersion(library.__version__) < LooseVersion(min_version):
    2022-05-16 14:42:34,069 INFO MainThread moabb.evaluations.base CSP+LDA | 001-2014 | 2 | session_E: Score 0.646
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/utils/check.py:92: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      LooseVersion(library.__version__) < LooseVersion(min_version):
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/utils/check.py:92: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      LooseVersion(library.__version__) < LooseVersion(min_version):
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/utils/check.py:92: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      LooseVersion(library.__version__) < LooseVersion(min_version):
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/utils/check.py:92: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      LooseVersion(library.__version__) < LooseVersion(min_version):
    2022-05-16 14:42:34,400 INFO MainThread moabb.evaluations.base CSP+LDA | 001-2014 | 2 | session_T: Score 0.527
    2022-05-16 14:42:34,800 INFO MainThread moabb.evaluations.base RG+LR | 001-2014 | 2 | session_E: Score 0.586
    2022-05-16 14:42:35,200 INFO MainThread moabb.evaluations.base RG+LR | 001-2014 | 2 | session_T: Score 0.575
    001-2014-CrossSession: 100%|##########| 2/2 [00:49<00:00, 24.55s/it]    001-2014-CrossSession: 100%|##########| 2/2 [00:49<00:00, 24.52s/it]
          score      time  samples subject  ... channels  n_sessions   dataset pipeline
    0  0.962963  0.407170    144.0       1  ...       22           2  001-2014    RG+LR
    1  0.950424  0.403718    144.0       1  ...       22           2  001-2014    RG+LR
    2  0.585648  0.385943    144.0       2  ...       22           2  001-2014    RG+LR
    3  0.574846  0.394616    144.0       2  ...       22           2  001-2014    RG+LR
    4  0.955440  0.397685    144.0       1  ...       22           2  001-2014  CSP+LDA

    [5 rows x 9 columns]




.. GENERATED FROM PYTHON SOURCE LINES 91-96

Plot Results
----------------

Here we plot the results. We first make a pointplot with the average
performance of each pipeline across session and subjects.

.. GENERATED FROM PYTHON SOURCE LINES 96-114

.. code-block:: default


    fig, axes = plt.subplots(1, 2, figsize=[8, 4], sharey=True)

    sns.stripplot(
        data=results,
        y="score",
        x="pipeline",
        ax=axes[0],
        jitter=True,
        alpha=0.5,
        zorder=1,
        palette="Set1",
    )
    sns.pointplot(data=results, y="score", x="pipeline", ax=axes[0], zorder=1, palette="Set1")

    axes[0].set_ylabel("ROC AUC")
    axes[0].set_ylim(0.5, 1)




.. image:: /auto_examples/images/sphx_glr_plot_cross_session_motor_imagery_001.png
    :alt: plot cross session motor imagery
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    (0.5, 1.0)



.. GENERATED FROM PYTHON SOURCE LINES 115-118

The second plot is a paired scatter plot. Each point representing the score
of a single session. An algorithm will outperform another is most of the
points are in its quadrant.

.. GENERATED FROM PYTHON SOURCE LINES 118-129

.. code-block:: default


    paired = results.pivot_table(
        values="score", columns="pipeline", index=["subject", "session"]
    )
    paired = paired.reset_index()

    sns.regplot(data=paired, y="RG+LR", x="CSP+LDA", ax=axes[1], fit_reg=False)
    axes[1].plot([0, 1], [0, 1], ls="--", c="k")
    axes[1].set_xlim(0.5, 1)

    plt.show()








.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  49.276 seconds)


.. _sphx_glr_download_auto_examples_plot_cross_session_motor_imagery.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_cross_session_motor_imagery.py <plot_cross_session_motor_imagery.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_cross_session_motor_imagery.ipynb <plot_cross_session_motor_imagery.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
